---
comments: true
date: 2011-01-18 20:14:58
layout: post
slug: awk-%e5%b0%8f%e7%8e%a9
title: Awk 小玩
wordpress_id: 1563
categories:
- PROGRAM
---

1 不用排序和uniq来删除文件中重复的行
[code language="bash"]awk '!x[$0]++' [/code]
例子
[code language="bash"]echo -e "aaa\nbbb\naaa\naa\nccc\naa"|awk \!'x[$0]++'[/code]
输出
[code language="bash"]aaaa
bbb
aa
cc[/code]
当然,要是找出重复的行,只需要把"!"去掉即可
2 计算一些特定文件的大小
例子1:当前文件夹下的所有文件的大小
[code language="bash"]als -l | awk '{s = s+$5 }; END { print s }'[/code]
例子2:当前文件夹以及其子文件夹下所有mp3文件的大小
[code language="bash"]als -lR *.mp3 | awk '{s = s+$5 }; END { print s }'[/code]
3 用find来实现上面的例子//当然没事找事复杂了
[code language="bash"]afind / -name .mp3 -exec ls -l {} \; | awk '{s = s+$5 }; END { print s }'[/code]
4 找出你的top10命令n
[code language="bash"]ahistory | awk '{a[$'`echo "1 2 $HISTTIMEFORMAT" | wc -w`']++}END{for(i in a){print a[i] "\t" i}}' | sort -rn | head -n10[/code]
5 把行号和域分解出来
[code language="bash"]aawk '{print NR": "$0; for(i=1;i<=NF;++i)print "\t"i": "$i}' /etc/passwd[/code]
6 重命名文件
[code language="bash"]als -1 pattern | awk '{print "mv "$1" "$1".new"}' | sh[/code]
当然也可是试试rename 's/png/jpg/' * //当然只是个例子而已

